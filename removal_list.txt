# Code Scanner - Unused/Unreachable Code Removal Recommendations
# Generated during test coverage analysis
# Final Coverage: 91% (430 tests passing)

## COVERAGE SUMMARY

| Module | Coverage | Notes |
|--------|----------|-------|
| issue_tracker.py | 100% | Fully covered |
| __init__.py | 100% | Fully covered |
| models.py | 99% | 1 line defensive code |
| utils.py | 97% | 2 lines edge case handling |
| output.py | 97% | 3 lines edge case handling |
| cli.py | 93% | 13 lines main loop code |
| config.py | 93% | 6 lines edge cases |
| llm_client.py | 90% | 17 lines error handling |
| scanner.py | 87% | 30 lines main loop code |
| git_watcher.py | 83% | 27 lines unicode/edge cases |
| __main__.py | 0% | Entry point - intentional |

### 1. src/code_scanner/__main__.py - Lines 3-7 (Entire file content)
**Status:** UNREACHABLE (0% coverage)
**Reason:** The `if __name__ == "__main__"` block in __main__.py is never executed 
because Python loads __main__.py specially when running `python -m code_scanner`.
The actual entry happens via the import mechanism, not the `if __name__` check.
**Recommendation:** Keep the file but remove the redundant if __name__ check, or
alternatively leave as-is since it provides documentation of intent and causes no harm.

### 2. src/code_scanner/cli.py - Lines 368-369 (if __name__ == "__main__" block)
**Status:** UNREACHABLE via normal test execution
**Reason:** This is a standard Python pattern for direct script execution. When the
module is imported (which is how tests run it), this block doesn't execute.
**Recommendation:** KEEP - This is intentional and follows Python conventions. It's
unreachable during testing but useful when running the file directly for debugging.

## HARD TO TEST CODE (Requires Integration/Manual Testing)

### 3. src/code_scanner/scanner.py - Lines 90-234 (_run_loop, _run_scan methods)
**Status:** Covered 42% - Main loop code
**Reason:** These methods involve the main scanner loop with threading, git state
monitoring, and LLM interactions. They require integration testing with real or
well-mocked components to achieve coverage.
**Recommendation:** KEEP - This is core functionality. Added integration tests target
these paths with mocked dependencies.

### 4. src/code_scanner/cli.py - Lines 80-117 (_setup method internals)
**Status:** Partially covered - component initialization
**Reason:** These lines handle component initialization, logging setup, and initial
output file creation. Some paths require integration testing.
**Recommendation:** KEEP - Core application setup logic.

### 5. src/code_scanner/cli.py - Lines 258-276 (_run_main_loop method)
**Status:** Uncovered - main event loop
**Reason:** This is the main application loop that waits for signals. It's inherently
difficult to unit test as it involves signal handling and thread synchronization.
**Recommendation:** KEEP - Core functionality. Consider adding a timeout-based
integration test.

### 6. src/code_scanner/cli.py - Lines 241-254 (_git_watch_loop method)
**Status:** Uncovered - git polling loop
**Reason:** Background thread loop that polls for git changes. Difficult to test
without real threading scenarios.
**Recommendation:** KEEP - Required for git change detection.

## DEFENSIVE CODE (Keep for Robustness)

### 7. src/code_scanner/models.py - Line 50
**Status:** Uncovered - edge case handling
**Reason:** This is likely a fallback/default case in Issue.from_llm_response that
handles malformed LLM responses.
**Recommendation:** KEEP - Defensive programming for robustness.

### 8. src/code_scanner/llm_client.py - Lines 114-124
**Status:** Uncovered - error recovery paths
**Reason:** Error handling paths for API failures and connection issues.
**Recommendation:** KEEP - Important for reliability.

### 9. src/code_scanner/git_watcher.py - Lines 239-253 (decode_octal_sequences)
**Status:** Uncovered - Unicode path handling
**Reason:** Helper function for decoding git's octal-escaped UTF-8 paths. Only
triggered with non-ASCII filenames in certain git versions.
**Recommendation:** KEEP - Important for internationalization support.

## NOT RECOMMENDED FOR REMOVAL

All code identified as "uncovered" serves a purpose:
- Threading/loop code is hard to unit test but essential
- Error handling paths are defensive programming
- Unicode handling supports internationalization
- Signal handlers are required for clean shutdown

## TESTING STRATEGY TO IMPROVE COVERAGE

1. **Scanner loops (_run_loop, _run_scan):** Test with mocked dependencies and
   artificial state changes via events.

2. **CLI main loop:** Add integration tests that run the full application with
   mocked LLM and simulated git changes, with timeouts.

3. **Git watcher loop:** Test via integration with temporary git repos.

4. **Error paths:** Add unit tests that inject specific error conditions.

## SUMMARY

- **Files with 0% coverage:** __main__.py (intentional - entry point pattern)
- **Truly unused code:** None identified - all uncovered code serves a purpose
- **Recommendation:** Focus on integration tests rather than removing code

The low coverage in scanner.py (42%) and cli.py (69%) is due to threading and
main loop code that requires integration testing, not unused code.
