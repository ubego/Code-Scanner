# Code Scanner Configuration for Java Projects
# Human-focused checks - linters (Checkstyle, SpotBugs) handle syntax/style.
#
# Copy this file to your project root as `config.toml`.

# ==============================================================================
# LLM Backend Configuration
# ==============================================================================

[llm]
# LM Studio (default)
backend = "lm-studio"   # Backend type: "lm-studio" or "ollama"
host = "localhost"       # Server hostname (usually localhost)
port = 1234              # Server port (LM Studio default: 1234, Ollama: 11434)
model = "qwen2.5-coder-7b-instruct"  # Optional for LM Studio
timeout = 600            # Request timeout in seconds
context_limit = 16384    # Context window size in tokens (minimum 16384 recommended)

# Ollama alternative (uncomment and comment out LM Studio above):
# backend = "ollama"     # Use Ollama backend
# host = "localhost"
# port = 11434           # Ollama default port
# model = "qwen3:4b"     # Model name (REQUIRED for Ollama)
# timeout = 600
# context_limit = 16384


# ==============================================================================
# Human-Focused Code Checks
# ==============================================================================

[[checks]]
pattern = "*.java"
checks = [
    # Architectural checks
    "Check that classes have a single responsibility.",
    "Check for circular dependencies between packages.",
    "Check that service layer does not call presentation layer directly.",
    "Check for god classes with too many methods or fields.",
    "Check for anemic domain models with only getters and setters.",
    # Concurrency checks
    "Check for shared mutable state without proper synchronization.",
    "Check for double-checked locking anti-pattern.",
    "Check for incorrect use of volatile keyword.",
    "Check for thread-unsafe singletons.",
    "Check for resource contention in critical sections.",
    "Check for missing timeout handling for locks.",
    # Resource management checks
    "Check that resources are closed in finally block or try-with-resources.",
    "Check for connection pool exhaustion patterns.",
    "Check for memory leaks from static collections.",
    "Check for incorrect transaction boundaries that are too broad or too narrow.",
    "Check for missing rollback handling for failed transactions.",
    # Security checks
    "Check for SQL injection via string concatenation including StringBuilder.",
    "Check that sensitive data like passwords, tokens, or PII is not logged.",
    "Check for deserialization of untrusted data.",
    "Check for insecure random number generation in security contexts.",
    "Check for hardcoded credentials or API keys.",
    "Check that user-supplied data is validated before use.",
    # API contract checks
    "Check that methods return Optional instead of null where appropriate.",
    "Check for breaking changes to public API without @Deprecated annotation.",
    "Check for inconsistent exception handling mixing checked and unchecked exceptions.",
    "Check for missing null checks for method parameters.",
    "Check for incorrect equals and hashCode implementations.",
    "Check for opportunities to optimize algorithms and data structures.",
]

[[checks]]
pattern = "*"
checks = [
    "Check for dead code or unused dependencies.",
    "Check for outdated TODO or FIXME comments.",
    "Check for copy-paste code that should be refactored.",
    "Check that test code tests behavior instead of implementation details.",
]
