# Code Scanner Configuration for Python Projects
# This example shows checks that require human judgment - not things linters catch.
#
# Copy this file to your project root as `config.toml` and customize as needed.

# ==============================================================================
# LLM Backend Configuration
# ==============================================================================

[llm]
# LM Studio (default)
backend = "lm-studio"   # Backend type: "lm-studio" or "ollama"
host = "localhost"       # Server hostname (usually localhost)
port = 1234              # Server port (LM Studio default: 1234, Ollama: 11434)
model = "qwen2.5-coder-7b-instruct"  # Optional for LM Studio
timeout = 600            # Request timeout in seconds
context_limit = 16384    # Context window size in tokens (minimum 16384 recommended)

# Ollama alternative (uncomment and comment out LM Studio above):
# backend = "ollama"     # Use Ollama backend
# host = "localhost"
# port = 11434           # Ollama default port
# model = "qwen3:4b"     # Model name (REQUIRED for Ollama)
# timeout = 600
# context_limit = 16384


# ==============================================================================
# Human-Focused Code Checks
# ==============================================================================
# These checks focus on issues that require semantic understanding.
# Linters (pylint, flake8, mypy) already handle syntax and style issues.

[[checks]]
pattern = "*.py"
checks = [
    # Architectural checks
    "Check that classes and functions have a single responsibility.",
    "Check for circular imports or circular dependencies between modules.",
    "Check that business logic is not placed in wrong layers (e.g., data validation in presentation layer).",
    "Check for god classes with too many public methods.",
    "Check for tight coupling between components that should be independent.",
    # Logic and semantic checks
    "Check for off-by-one errors in loops, slices, or range() calls.",
    "Check for incorrect boundary conditions (< vs <=, > vs >=).",
    "Check for resource leaks where files, connections, or locks are not properly closed or released.",
    "Check for race conditions in multi-threaded code with shared state mutations.",
    "Check for incorrect assumptions about data ordering or uniqueness.",
    # Security checks
    "Check for SQL queries with any form of string interpolation including f-strings.",
    "Check that user input passed to os.system(), subprocess, or exec() is properly sanitized.",
    "Check that secrets or tokens are not logged in error messages or debug output.",
    "Check that authentication and authorization checks are present in critical paths.",
    "Check for insecure deserialization using pickle or yaml.load without Loader.",
    "Check for path traversal vulnerabilities where user input is used in file paths.",
    # API contract checks
    "Check that functions return consistent types and do not vary by code path.",
    "Check for breaking changes to public function signatures without versioning.",
    "Check for inconsistent error handling where functions sometimes raise and sometimes return None.",
    "Check that external API responses are validated before use.",
    "Check for incorrect HTTP status codes in REST endpoints.",
    # Domain-specific checks
    "Check for hardcoded business rules that should be configurable.",
    "Check for date and time handling without proper timezone awareness.",
    "Check for currency or money calculations using float instead of Decimal.",
    "Check for incorrect handling of Unicode strings or encodings.",
    "Check for missing retry logic for network operations.",
    "Check for opportunities to optimize algorithms and data structures.",
]

[[checks]]
pattern = "*"
checks = [
    "Check for entire files that are never imported or used.",
    "Check for feature flags or conditional code for features that shipped long ago.",
    "Check for commented-out code blocks larger than 3 lines.",
    "Check for TODO or FIXME comments that appear outdated.",
    "Check for duplicate implementations of similar logic across files.",
    "Check that all changed code paths handle edge cases and error conditions correctly.",
    "Check that the overall design fits the existing architecture and abstractions.",
    "Check that complex logic is broken down into small, understandable units with clear responsibilities.",
    "Check that names of variables, methods, and classes are clear, descriptive, and consistent.",
    "Check for obvious performance issues like N+1 queries or unnecessary loops.",
    "Check that database queries and external service calls are efficient and properly constrained.",
    "Check that public APIs, configuration changes, or new behaviors are properly documented.",
    "Check that comments and documentation are accurate, necessary, and up to date.",
    "Check that logging and error messages are clear, informative, and follow project conventions.",
    "Check that no sensitive data (keys, PII) is logged or exposed in output.",
    "Check that configuration changes have safe, sensible defaults.",
    "Check that feature flags are named consistently and reflect their purpose.",
]

# ==============================================================================
# Ignore Patterns (files to skip during scanning)
# ==============================================================================
# Files matching these patterns with empty checks will be ignored.
# Add or modify patterns as needed for your project.

[[checks]]
pattern = "*.md, *.txt, *.rst, *.html, *.json, *.toml, *.yaml, *.yml"
checks = []
