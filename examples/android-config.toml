# Code Scanner Configuration for Android Projects (Java + Kotlin)
# Human-focused checks - Android Lint handles syntax/style.
#
# Copy this file to your project root as `config.toml`.

# ==============================================================================
# LLM Backend Configuration
# ==============================================================================

[llm]
# LM Studio (default)
backend = "lm-studio"   # Backend type: "lm-studio" or "ollama"
host = "localhost"       # Server hostname (usually localhost)
port = 1234              # Server port (LM Studio default: 1234, Ollama: 11434)
model = "qwen2.5-coder-7b-instruct"  # Optional for LM Studio
timeout = 600            # Request timeout in seconds
context_limit = 16384    # Context window size in tokens (minimum 16384 recommended)

# Ollama alternative (uncomment and comment out LM Studio above):
# backend = "ollama"     # Use Ollama backend
# host = "localhost"
# port = 11434           # Ollama default port
# model = "qwen3:4b"     # Model name (REQUIRED for Ollama)
# timeout = 600
# context_limit = 16384


# ==============================================================================
# Human-Focused Code Checks
# ==============================================================================

[[checks]]
pattern = "*.java, *.kt"
checks = [
    # Lifecycle checks
    "Check that operations started in onCreate or onStart are cancelled in onDestroy or onStop.",
    "Check for context leaks where Activity context is stored in static or long-lived objects.",
    "Check that observers and listeners are removed when the view is destroyed.",
    "Check that scheduled work considers app lifecycle.",
    "Check that coroutines and async tasks are properly scoped to lifecycle.",
    # Threading checks
    "Check that UI operations are not performed from background threads.",
    "Check that blocking operations are not performed on the main thread.",
    "Check that LiveData and StateFlow are observed on the correct thread.",
    "Check that shared mutable state is synchronized.",
    "Check for Handler and Looper misuse.",
    # Memory checks
    "Check that inner classes do not hold implicit reference to Activity.",
    "Check that Bitmaps are recycled and sized correctly.",
    "Check that large objects are cached with limits.",
    "Check that RecyclerView ViewHolder does not leak views.",
    "Check for unbounded growth of collections.",
    # Security checks
    "Check that sensitive data in SharedPreferences is encrypted.",
    "Check that API keys and secrets are not in code or resources.",
    "Check that WebView with JavaScript validates content properly.",
    "Check that Intent data is validated before use.",
    "Check that exported components have proper permissions.",
    "Check that SQL queries are not built with string concatenation.",
    # Architecture checks
    "Check that View layer does not directly access database or network.",
    "Check that business logic is not in Activities or Fragments.",
    "Check for god Activities or ViewModels with too many responsibilities.",
    "Check for circular dependencies between modules.",
    "Check that repository pattern is used for data access.",
    # UX and performance checks
    "Check that network calls are not made in adapter onBindViewHolder.",
    "Check for missing offline support for features that need it.",
    "Check that large images are properly downscaled.",
    "Check that animations do not block user interaction.",
    "Check for missing empty, error, or loading states for data screens.",
    "Check for opportunities to optimize algorithms and data structures.",
]

[[checks]]
pattern = "*.xml"
checks = [
    "Check for deeply nested view hierarchies that should use ConstraintLayout.",
    "Check that dimensions use dp or sp instead of hardcoded values.",
    "Check that content descriptions are present for accessibility.",
    "Check for overdraw from overlapping opaque backgrounds.",
]

[[checks]]
pattern = "*"
checks = [
    "Check for unused resources or dependencies.",
    "Check for feature flags for features that shipped long ago.",
    "Check for dead code paths that were not cleaned up.",
]
